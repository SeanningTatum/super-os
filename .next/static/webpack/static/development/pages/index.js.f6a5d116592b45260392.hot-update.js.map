{"version":3,"file":"static/webpack/static/development/pages/index.js.f6a5d116592b45260392.hot-update.js","sources":["webpack:///./hocs/defaultPage.js"],"sourcesContent":["import React from 'react'\nimport Router from 'next/router'\nimport styled from 'styled-components'\n\nimport AuthService from '../utils/authService'\nimport {unsecuredPages} from '../utils/constants'\nimport redirect from '../lib/redirect'\nimport DefaultLayout from '../layout/defaultLayout'\n\nconst App = styled.main`\n  height: 100vh;\n`\nexport default Page =>\n  class DefaultPage extends React.Component {\n    static getInitialProps(ctx) {\n      const loggedUser = process.browser\n        ? AuthService.getUserFromLocalCookie()\n        : AuthService.getUserFromServerCookie(ctx.req)\n\n      const isAuthenticated = !!loggedUser\n      const pageProps = Page.getInitialProps && Page.getInitialProps(ctx)\n\n      // If user is authenticated and is the unsecuredPagesArray\n      // redirect user to somewhere useful.\n      if (isAuthenticated && unsecuredPages.includes(ctx.pathname)) {\n        redirect(ctx, '/')\n        return {\n          ...pageProps,\n        }\n      }\n\n      return {\n        ...pageProps,\n        loggedUser,\n        isAuthenticated,\n        currentUrl: ctx.pathname,\n      }\n    }\n\n    componentDidMount() {\n      window.addEventListener('storage', this.logout, false)\n    }\n\n    componentWillUnmount() {\n      window.removeEventListener('storage', this.logout, false)\n    }\n\n    logout = eve => {\n      console.log('in here')\n      if (eve.key === 'logout') {\n        Router.push(`/?logout=${eve.newValue}`)\n      }\n    }\n\n    render() {\n      const {props} = this\n\n      return (\n        <App>\n          {props.isAuthenticated ? (\n            <React.Fragment>\n              <Page {...props} />\n            </React.Fragment>\n          ) : (\n            <DefaultLayout>\n              <Page {...props} />\n            </DefaultLayout>\n          )}\n        </App>\n      )\n    }\n  }\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AACA;AADA;AACA;AADA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAoCA;AACA;AAAA;AACA;AACA;AACA;AACA;AAzCA;AAAA;AACA;AADA;AAAA;AAAA;AA4BA;AACA;AA7BA;AAAA;AAAA;AAgCA;AACA;AAjCA;AAAA;AAAA;AA0CA;AAGA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AA1DA;AAAA;AAAA;AAGA;AAIA;AACA;AAGA;AACA;AAAA;AACA;AACA;AAGA;AACA;AACA;AAEA;AACA;AACA;AAJA;AAMA;AAzBA;AACA;AADA;AAAA;AAAA;AAAA;;;;A","sourceRoot":""}