{"version":3,"file":"static/webpack/static/development/pages/index.js.1d103a1024dee351f84b.hot-update.js","sources":["webpack:///./hocs/defaultPage.js"],"sourcesContent":["import React from 'react'\nimport Head from 'next/head'\nimport Router from 'next/router'\nimport styled from 'styled-components'\n\nimport AuthService from '../utils/authService'\nimport {unsecuredPages} from '../utils/constants'\nimport redirect from '../lib/redirect'\n\nconst App = styled.main`\n  height: 100vh;\n  width: 100vw;\n`\n\nconst Main = styled.div`\n  max-width: 1024px;\n  margin: 0 auto;\n  padding: 30px;\n`\n\nexport default Page =>\n  class DefaultPage extends React.Component {\n    static getInitialProps(ctx) {\n      const loggedUser = process.browser\n        ? AuthService.getUserFromLocalCookie()\n        : AuthService.getUserFromServerCookie(ctx.req)\n\n      const isAuthenticated = !!loggedUser\n      const pageProps = Page.getInitialProps && Page.getInitialProps(ctx)\n\n      // If user is authenticated and is the unsecuredPagesArray\n      // redirect user to somewhere useful.\n      if (isAuthenticated && unsecuredPages.includes(ctx.pathname)) {\n        redirect(ctx, '/')\n        return {\n          ...pageProps,\n        }\n      }\n\n      return {\n        ...pageProps,\n        loggedUser,\n        isAuthenticated,\n        currentUrl: ctx.pathname,\n      }\n    }\n\n    constructor(props) {\n      super(props)\n\n      this.logout = this.logout.bind(this)\n    }\n\n    logout(eve) {\n      if (eve.key === 'logout') {\n        Router.push(`/?logout=${eve.newValue}`)\n      }\n    }\n\n    componentDidMount() {\n      window.addEventListener('storage', this.logout, false)\n    }\n\n    componentWillUnmount() {\n      window.removeEventListener('storage', this.logout, false)\n    }\n\n    render() {\n      return (\n        <App>\n          {this.props.isAuthenticated && (\n            <React.Fragment>\n              <Header />\n              <Page {...this.props} />\n            </React.Fragment>\n          )}\n        </App>\n      )\n    }\n  }\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAGA;AAIA;AACA;AAGA;AACA;AAAA;AACA;AACA;AAGA;AACA;AACA;AAEA;AACA;AACA;AAJA;AAMA;AAzBA;AACA;AA0BA;AAAA;AACA;AADA;AACA;AAAA;AAEA;AAHA;AAIA;AACA;AAhCA;AAAA;AAAA;AAkCA;AACA;AACA;AACA;AArCA;AAAA;AAAA;AAwCA;AACA;AAzCA;AAAA;AAAA;AA4CA;AACA;AA7CA;AAAA;AAAA;AAgDA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AA1DA;AACA;AADA;AAAA;AAAA;AAAA;;;;A","sourceRoot":""}